# Инструменты работы с данными. Чтение текстовых файлов (виды файлов). Чтение файлов Excel: чтение данных с нескольких листов и объединение данных. Функция concat. Циклы for и while

## 1. Инструменты работы с данными:
#### 1. Описательная аналитика:
*   Отчеты
*   Дэшборды
#### 2. Диагностическая аналитика
*   Навигация
*   OLAP/Мультисферы
*   Agile визуализация
*   Скрытые закономерности и аномалии
*   Сегментация
*   Кластеризация
*   Ассоциативные правила
#### 3. Предиктивная аналитика / machine learning
*   Классификация
*   Регрессия
*   Временные ряды
*   Ассоциативные правила
*   Анализ текста
*   Анализ ссылок
*   Обработка сигналов
#### 4. Прескриптивная аналитика
*   Рекомендации
*   Автоматизация ВРМ
*   Оптимизация
*   Управление моделями
*   Управление расписанием

---

## 2. Работа с файлами в Python

### Чтение текстовых файлов
Чаще всего работа с файлами осуществляется при помощи встроенной функции open() и менеджера контекста with:

```python
with open('file.txt', 'r', encoding='utf-8') as file:
    data = file.read() # Чтения файла целиков

    # Файлы также можно итерировать построчно
    for line in data:
        prnt(line.strip())
```
Имеет следующие параметры:
*   Режим доступа - `'r'` (чтение), `'w'` (запись в файл), `'a'` (добавление данных в конец файла)
*   Кодировка - `encoding='utf-8'`

### Чтение файлов Excel
Для работы с Excel-файлами используется библиотека Pandas.

#### Чтение данных с одного листа

```python
import pandas as pd

# Путь к файлу
file_path = 'data.xlsx'

# Считываение данных
data = pd.read_excel(file_path, sheet_name=0, skiprows=1)
```

Имеет следующие необязательные параметры:
*   Имя листа, с которого считываются данные - `sheet_name`, по умолчанию равен 0
*   Число строк, которые пропускаются по умолчанию - `skiprows`, по умолчанию равен 0

#### Чтение данных с нескольких листов

```python
# Путь к файлу
file_path = 'report_2026.xlsx'

# 1. Получаем список всех листов в файле
excel_file = pd.ExcelFile(file_path)
sheet_names = excel_file.sheet_names # ['Январь', 'Февраль', ...]

# 2. Список для хранения данных с каждого листа
all_sheets_data = []

# 3. Цикл для чтения каждого листа
for sheet in sheet_names:
    df = pd.read_excel(file_path, sheet_name=sheet)
    # Можно добавить колонку, чтобы знать, из какого листа данные
    df['Источник'] = sheet
    all_sheets_data.append(df)

# 4. Объединение данных (Функция concat)
final_df = pd.concat(all_sheets_data, ignore_index=True)
```

#### Функция `pd.concat()`
Встроенная в библиотеку Pandas функция, которая используется для "склеивания" таблиц вдоль выбранной оси (по умолчанию по строкам)
*   `objs` - список объектов типа `DataFrame` (тип данных из библиотеки Pandas)
*   `ignore_index` - используется для создания нового, сквозного индекса для новой таблицы
*   `axis` - 0 для объединения по строкам, 1 для объединения по столбцам

---

## 3. Циклы в python

#### Цикл `for`
Используется для итерации элементов последовательности (список, кортеж, генераторный объект, строка итд)

```python
collection = range(1, 100)

for i in collection:
    print(i)
```

#### Цикл `while`
Выполняется, пока верно условие. Используется в ситуациях, когда заранее неизвестно число итераций

```python
count = 0

while count < 5:
    print(count)
    count += 1
```
